---
title: "Lab 05- Wrangling spatial data"
author: "Cat Seitz"
date: "01/31/2023"
output: github_document
---

### Load packages and data

```{r load-packages, message = FALSE}
library(tidyverse) 
library(dsbox) 
```

```{r load-data, message = FALSE}
states <- read_csv("data/states.csv")
```

### Exercise 1

```{r filter_dennys_for_alaska}

dn<-dennys

dn_ak <- dn %>%
  filter(state == "AK")
nrow(dn_ak)

```
There are 3 Denny's locations in Alaska. 

### Exercise 2

```{r filter_lq_for_alaska}

lq<-laquinta

lq_ak <- lq %>%
  filter(state == "AK")
nrow(lq_ak)

```

There are 2 La Quinta locations in Alaska. 

### Exercise 3

We need to calculate 6 distances between the Alaska establishment locations. 

```{r join_dataframes}

dn_lq_ak <- full_join(dn_ak, lq_ak, by = "state")
dn_lq_ak

```

### Exercise 4

There are 6 observations in our joined data frame, which aligns with what we want. The variables are the addresses of the Denny's and La Quinta locations, as well as their longitudes and latitudes. The data frame is organized so each row is a pair of Denny's and La Quinta locations, with none repeating. 

### Exercise 5

```{r haversine}

haversine <- function(long1, lat1, long2, lat2, round = 3) {
  # convert to radians
  long1 = long1 * pi / 180
  lat1  = lat1  * pi / 180
  long2 = long2 * pi / 180
  lat2  = lat2  * pi / 180
  
  R = 6371 # Earth mean radius in km
  
  a = sin((lat2 - lat1)/2)^2 + cos(lat1) * cos(lat2) * sin((long2 - long1)/2)^2
  d = R * 2 * asin(sqrt(a))
  
  return( round(d,round) ) # distance in km
}

```



### Exercise 6

I added a column to the Denny's and La Quinta's in Alaska data frame for the distance between each pair of locations. 

```{r calc_distance}

dn_lq_ak$distance <-
  haversine(dn_lq_ak$longitude.x,
            dn_lq_ak$latitude.x,
            dn_lq_ak$longitude.y,
            dn_lq_ak$latitude.y,
            3)

```

Add exercise headings as needed.
